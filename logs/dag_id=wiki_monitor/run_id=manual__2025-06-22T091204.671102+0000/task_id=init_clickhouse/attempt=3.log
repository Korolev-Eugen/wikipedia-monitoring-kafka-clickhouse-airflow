{"timestamp":"2025-06-22T09:14:07.349631","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-22T09:14:07.350054","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/wiki_monitoring.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-22T09:14:07.476425","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"ServerException","exc_value":"Code: 47.\nDB::Exception: Missing columns: 'dt' while processing: 'dt, title', required columns: 'dt' 'title', available columns: 'server_name' 'is_bot' 'user' 'title' 'tiemestamp'. Stack trace:\n\n0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f88f17b\n1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009da318c\n2. DB::TreeRewriterResult::collectUsedColumns(std::shared_ptr<DB::IAST> const&, bool, bool) @ 0x0000000013b7bd80\n3. DB::TreeRewriter::analyze(std::shared_ptr<DB::IAST>&, DB::NamesAndTypesList const&, std::shared_ptr<DB::IStorage const>, std::shared_ptr<DB::StorageSnapshot> const&, bool, bool, bool, bool) const @ 0x0000000013b869d7\n4. DB::KeyDescription::getSortingKeyFromAST(std::shared_ptr<DB::IAST> const&, DB::ColumnsDescription const&, std::shared_ptr<DB::Context const>, std::optional<String> const&) @ 0x00000000141eed82\n5. DB::create(DB::StorageFactory::Arguments const&) @ 0x0000000014c73798\n6. DB::StorageFactory::get(DB::ASTCreateQuery const&, String const&, std::shared_ptr<DB::Context>, std::shared_ptr<DB::Context>, DB::ColumnsDescription const&, DB::ConstraintsDescription const&, DB::LoadingStrictnessLevel, bool) const @ 0x000000001424ea9b\n7. DB::InterpreterCreateQuery::doCreateTable(DB::ASTCreateQuery&, DB::InterpreterCreateQuery::TableProperties const&, std::unique_ptr<DB::DDLGuard, std::default_delete<DB::DDLGuard>>&, DB::LoadingStrictnessLevel) @ 0x00000000138311ed\n8. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x0000000013825fa2\n9. DB::InterpreterCreateQuery::execute() @ 0x00000000138396d8\n10. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x0000000013c17628\n11. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013c10d26\n12. DB::TCPHandler::runImpl() @ 0x0000000014fa4c7e\n13. DB::TCPHandler::run() @ 0x0000000014fc39f9\n14. Poco::Net::TCPServerConnection::start() @ 0x00000000186e4307\n15. Poco::Net::TCPServerDispatcher::run() @ 0x00000000186e4759\n16. Poco::PooledThread::run() @ 0x00000000186afa5b\n17. Poco::ThreadImpl::runnableEntry(void*) @ 0x00000000186adf3d\n18. ? @ 0x000075e61aab0ac3\n19. ? @ 0x000075e61ab42850\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":825,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1088,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/wiki_monitoring.py","lineno":29,"name":"init_clickhouse"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":382,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":580,"name":"process_ordinary_query"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":213,"name":"receive_result"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/result.py","lineno":50,"name":"get_result"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":229,"name":"packet_generator"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":246,"name":"receive_packet"}]}]}
