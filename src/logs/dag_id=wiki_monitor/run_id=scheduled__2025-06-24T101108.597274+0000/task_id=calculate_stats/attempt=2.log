{"timestamp":"2025-06-24T10:12:14.419283","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-24T10:12:14.419647","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/wiki_monitoring.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-24T10:12:14.528491","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"ServerException","exc_value":"Code: 62.\nDB::Exception: Syntax error: failed at position 98 (toStartOfHour) (line 5, col 13): toStartOfHour(timestamp) as hour,\n            count() as edits_count,\n            uniq(user) as unique_users,\n            sum(is_bot) / count() as bot_edits_ratio,\n... Expected one of: token, Comma, FROM, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT, FORMAT, ParallelWithClause, PARALLEL WITH, end of query. Stack trace:\n\n0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f88f17b\n1. DB::Exception::createDeprecated(String const&, int, bool) @ 0x000000000f958d2d\n2. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x0000000015acd3f2\n3. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x0000000013c11ac5\n4. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013c10d26\n5. DB::TCPHandler::runImpl() @ 0x0000000014fa4c7e\n6. DB::TCPHandler::run() @ 0x0000000014fc39f9\n7. Poco::Net::TCPServerConnection::start() @ 0x00000000186e4307\n8. Poco::Net::TCPServerDispatcher::run() @ 0x00000000186e4759\n9. Poco::PooledThread::run() @ 0x00000000186afa5b\n10. Poco::ThreadImpl::runnableEntry(void*) @ 0x00000000186adf3d\n11. ? @ 0x00007026d20a0ac3\n12. ? @ 0x00007026d2132850\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":825,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1088,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/wiki_monitoring.py","lineno":152,"name":"calculate_stats"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":382,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":580,"name":"process_ordinary_query"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":213,"name":"receive_result"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/result.py","lineno":50,"name":"get_result"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":229,"name":"packet_generator"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":246,"name":"receive_packet"}]}]}
